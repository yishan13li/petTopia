<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商家註冊 - Waggy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
          crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@300;400;700&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" type="text/css" th:href="@{/user_static/css/vendor.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/user_static/css/style.css}">
    
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Comic Neue', cursive;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: url('/user_static/images/background-img.png') no-repeat center center/cover;
        }
        /* Header Styles */
        header {
            background-color: #ffffff;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            font-size: 24px;
            font-weight: bold;
            margin: 0;
        }

        .register-container {
            width: 25%; /* 設定適中的寬度 */
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            margin: 2rem auto;
            flex-grow: 1;
            margin-left: 65%; /* 將左側間距設為 20%，使其在頁面中間偏右 */
            margin-right: 0;
        }
        .social-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .social-btn img {
            width: 24px;
            height: 24px;
            margin-right: 10px;
        }

        .social-btn1 {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .social-btn1 img {
            width: 36px;
            height: 36px;
            margin-right: 5px;
        }
        .divider {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    position: relative;
}

.divider::before,
.divider::after {
    content: "";
    flex-grow: 1; /* 讓左右線條自動填滿 */
    height: 1px;
    background-color: #ccc;
}

.divider span {
    color: #ccc;
    font-size: 0.75rem;
    padding: 0 16px;
    text-transform: uppercase;
    font-weight: bold;
    white-space: nowrap;
    background: white; /* 確保背景顏色不會讓文字被線擋住 */
    z-index: 1; /* 讓 "或" 文字顯示在上層 */
}


        /* Footer Styles */
        footer {
            background-color: #ffffff;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
        }

        footer p {
            font-size: 14px;
            margin: 0;
        }
        footer .social-links {
            margin-top: 20px; /* 這裡加上 margin-top 調整圖示間距 */
        }

        footer .search-bar {
            margin-top: 20px; /* 這裡加上 margin-top 調整搜尋列位置 */
        }
    </style>
</head>

    <img th:src="@{/user_static/images/vendor_register_background.png}" 
         style="position: absolute;
                left: 40%;
                top: 60%;
                transform: translate(-50%, -50%);
                width: 500px;
                height: auto;
                z-index: 1;">

  <!-- Header Section -->
  <header>
      <div class="container py-2">
          <div class="row py-4 pb-0 pb-sm-4 align-items-center">
              <div class="col-sm-4 col-lg-3 text-center text-sm-start">
                  <div class="main-logo d-flex align-items-center justify-content-center justify-content-sm-start">
                      <a href="index.html" class="d-flex align-items-center text-decoration-none">
                          <img th:src="@{/user_static/images/logo.png}" alt="logo" class="img-fluid">
                          <h1 class="mb-0" style="font-size: 32px; 
                                                margin-left: 15px; 
                                              
                                                color: #2B4F76;
                                                font-family: 'Noto Sans TC', sans-serif;
                                                white-space: nowrap;
                                                writing-mode: horizontal-tb;">商家註冊</h1>
                      </a>
                  </div>
              </div>
          </div>
      </div>

      <div class="container-fluid">
          <hr class="m-0">
      </div>
  </header>

  <!-- Main Content -->
  <div class="register-container">
      <h2 class="mb-4">商家註冊</h2>
      <form th:action="@{/vendor/vendor_register/controller}" method="post" id="registerForm">
          <div class="form-group">
              <label for="email">電子郵件</label>
              <input type="email" id="email" name="email" class="form-control" required>
              <div class="error" th:if="${errors != null && errors.containsKey('email')}" 
                   th:text="${errors.get('email')}"></div>
              
              <div class="verification-area mt-2">
                  <div class="d-flex gap-2">
                      <input type="text" id="verificationCode" name="verificationCode" 
                             class="form-control" placeholder="請輸入驗證碼" required>
                      <button type="button" id="sendVerificationBtn" 
                              class="btn btn-secondary">發送驗證碼</button>
                  </div>
                  <div class="error" th:if="${errors != null && errors.containsKey('verificationCode')}" 
                       th:text="${errors.get('verificationCode')}"></div>
              </div>
          </div>

          <div class="form-group">
              <label for="password">密碼</label>
              <input type="password" id="password" name="password" class="form-control" required>
              <div class="error" th:if="${errors != null && errors.containsKey('password')}" 
                   th:text="${errors.get('password')}"></div>
          </div>

          <div class="form-group">
              <label for="confirmPassword">確認密碼</label>
              <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
              <div class="error" th:if="${errors != null && errors.containsKey('confirmPassword')}" 
                   th:text="${errors.get('confirmPassword')}"></div>
          </div>

          <button type="submit" class="btn btn-primary">註冊</button>
      </form>
      <div class="divider"><span>或</span></div>
      <a href="/oauth2/authorization/facebook" class="social-btn">
          <img src="/user_static/icon/Facebook_icon.png" alt="Facebook"> 使用 Facebook 註冊
      </a>
      <a href="/oauth2/authorization/google" class="social-btn1">
          <img src="/user_static/icon/Google_icon.png" alt="Google"> 使用 Google 註冊
      </a>
      <p class="text-center mt-3">已有帳號？ <a href="login.jsp">登入</a></p>
      
  </div>
  
  <!-- Footer Section -->

 <footer id="footer" class="my-5">
  <div class="container py-5 my-5">
    <div class="row">

      <div class="col-md-3">
        <div class="footer-menu">
          <img th:src="@{/user_static/images/logo.png}" alt="logo">
          <p class="blog-paragraph fs-6 mt-3">Subscribe to our newsletter to get updates about our grand offers.</p>
          <div class="social-links">
            <ul class="d-flex list-unstyled gap-2">
              <li class="social">
                <a href="#">
                  <iconify-icon class="social-icon" icon="ri:facebook-fill"></iconify-icon>
                </a>
              </li>
              <li class="social">
                <a href="#">
                  <iconify-icon class="social-icon" icon="ri:twitter-fill"></iconify-icon>
                </a>
              </li>
              <li class="social">
                <a href="#">
                  <iconify-icon class="social-icon" icon="ri:pinterest-fill"></iconify-icon>
                </a>
              </li>
              <li class="social">
                <a href="#">
                  <iconify-icon class="social-icon" icon="ri:instagram-fill"></iconify-icon>
                </a>
              </li>
              <li class="social">
                <a href="#">
                  <iconify-icon class="social-icon" icon="ri:youtube-fill"></iconify-icon>
                </a>
              </li>

            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="footer-menu">
          <h3>Quick Links</h3>
          <ul class="menu-list list-unstyled">
            <li class="menu-item">
              <a href="#" class="nav-link">Home</a>
            </li>
            <li class="menu-item">
              <a href="#" class="nav-link">About us</a>
            </li>
            <li class="menu-item">
              <a href="#" class="nav-link">Offer </a>
            </li>
            <li class="menu-item">
              <a href="#" class="nav-link">Services</a>
            </li>
            <li class="menu-item">
              <a href="#" class="nav-link">Conatct Us</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="col-md-3">
        <div class="footer-menu">
          <h3>Help Center</h5>
            <ul class="menu-list list-unstyled">
              <li class="menu-item">
                <a href="#" class="nav-link">FAQs</a>
              </li>
              <li class="menu-item">
                <a href="#" class="nav-link">Payment</a>
              </li>
              <li class="menu-item">
                <a href="#" class="nav-link">Returns & Refunds</a>
              </li>
              <li class="menu-item">
                <a href="#" class="nav-link">Checkout</a>
              </li>
              <li class="menu-item">
                <a href="#" class="nav-link">Delivery Information</a>
              </li>
            </ul>
        </div>
      </div>
      <div class="col-md-3">
        <div>
          <h3>Our Newsletter</h3>
          <p class="blog-paragraph fs-6">Subscribe to our newsletter to get updates about our grand offers.</p>
          <div class="search-bar border rounded-pill border-dark-subtle px-2">
            <form class="text-center d-flex align-items-center" action="" method="">
              <input type="text" class="form-control border-0 bg-transparent" placeholder="Enter your email here" />
              <iconify-icon class="send-icon" icon="tabler:location-filled"></iconify-icon>
            </form>
          </div>
        </div>
      </div>

    </div>
  </div>
</footer>

<div id="footer-bottom">
  <div class="container">
    <hr class="m-0">
    <div class="row mt-3">
      <div class="col-md-6 copyright">
        <p class="secondary-font">© 2023 Waggy. All rights reserved.</p>
      </div>
      <div class="col-md-6 text-md-end">
        <p class="secondary-font">Free HTML Template by <a href="https://templatesjungle.com/" target="_blank"
            class="text-decoration-underline fw-bold text-black-50"> TemplatesJungle</a> Distributed by <a
            href="https://themewagon.com/" target="_blank" class="text-decoration-underline fw-bold text-black-50">
            ThemeWagon</a></p>
      </div>
    </div>
  </div>
</div>

<script>
document.getElementById("registerForm").addEventListener("submit", function(event) {
    event.preventDefault(); // 阻止表單自動提交
    
    const email = document.getElementById("email").value;
    const verificationCode = document.getElementById("verificationCode").value;
    
    if (!verificationCode) {
        alert("請輸入驗證碼");
        return;
    }

    // 先驗證驗證碼
    fetch('/vendor/verify-code', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: `email=${encodeURIComponent(email)}&code=${encodeURIComponent(verificationCode)}`
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // 驗證碼正確，提交表單
            this.submit();
        } else {
            alert(data.message || "驗證碼錯誤");
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert("驗證失敗，請稍後重試");
    });
});

function moveToNext(input, index) {
  if (input.value.length === 1) {
      if (index < 5) {
          document.getElementById(`code${index + 2}`).focus();
      }   
  } else if (input.value.length === 0 && index > 0) {
      document.getElementById(`code${index}`).focus();
  }
}

function startTimer() {
  let timeLeft = 5 * 60; // 5 minutes in seconds
  const timerDisplay = document.getElementById('countdown');
  
  const countdownTimer = setInterval(() => {
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      
      // Format display with leading zeros
      timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      if (timeLeft <= 0) {
          clearInterval(countdownTimer);
          alert('驗證碼已過期，請重新發送');
          // Optionally, redirect back to registration form
          document.querySelector(".verification-container").style.display = "none";
          document.querySelector(".register-container").style.display = "block";
      }
      
      timeLeft--;
  }, 1000);
}

document.getElementById('sendVerificationBtn').addEventListener('click', function() {
    const email = document.getElementById('email').value;
    
    if (!email) {
        alert('請輸入電子郵件');
        return;
    }

    fetch('/vendor/send-verification', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: 'email=' + encodeURIComponent(email)
})
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('驗證碼已發送到您的郵箱');
        } else {
            alert(data.message || '發送失敗，請稍後再試');
        }
    })
    .catch(error => {
        alert('發送失敗，請稍後再試');
    });
});

function startCountdown(button) {
    let totalSeconds = 5 * 60; // 5分鐘 = 300秒
    const timer = setInterval(() => {
        if (totalSeconds > 0) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            // 格式化顯示，確保分鐘和秒都是兩位數
            const timeDisplay = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            button.textContent = `重新發送(${timeDisplay})`;
            totalSeconds--;
        } else {
            clearInterval(timer);
            button.disabled = false;
            button.textContent = "發送驗證碼";
        }
    }, 1000);
}
</script>
<script th:src="@{/user_static/js/jquery-1.11.0.min.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
  crossorigin="anonymous"></script>
<script th:src="@{/user_static/js/plugins.js}"></script>
<script th:src="@{/user_static/js/script.js}"></script>
<script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
</body>
</html>